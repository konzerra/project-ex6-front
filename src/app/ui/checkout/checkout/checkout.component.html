<div *ngIf="cart.length<1" class="empty-cart">
    <mat-icon >
      shopping_bag
    </mat-icon>
    <h3>Empty cart</h3>
    <a routerLink="/category">
      View products
    </a>
  </div>


<mat-stepper *ngIf="cart.length>0"
  class="mat-step-header"
  [orientation]="(stepperOrientation | async)!">
  <mat-step label="Review the order">
    <div class="col-md-5">
      <div *ngFor="let item of cart" class="grid-container">
        <div>
          <label>{{item.product.name}}</label>
          <p>Quantity: {{item.quantity}}</p>
          <p>Total: {{item.product.price * item.quantity}}</p>
        </div>
        <div>
          <p>Price: {{item.product.price}}</p>
        </div>
        <mat-divider></mat-divider>
      </div>

      <label>Total sum: {{totalPrice}}$</label>
      <div class="mt-3">
        <button class="p-btn-dark-on-white"  matStepperNext>Next</button>
      </div>
    </div>
  </mat-step>

  <mat-step [stepControl]="personalInfo" label="Fill out your contact info">
    <div class="col-md-6">
    </div>
    <form [formGroup]="personalInfo"  class="col-md-6">
      <div class="form-panel-dark-on-white">
        <label class="mt-3" for="postalCode"> First name, last name </label>
        <input type="text"
               id="name"
               class="form-input"
               [formControl]="personalInfoForm.name"
               placeholder="Enter your name"
               required autofocus="autofocus" />
        <div *ngIf="checkFormControl(personalInfoForm.name)"
             class="alert-danger-parent">
          <div class="alert-danger" *ngIf="checkFormControl(personalInfoForm.name)">
            Enter your name
          </div>
        </div>
      </div>
      <div class="form-panel-dark-on-white">
        <label class="mt-3" for="postalCode"> Email </label>
        <input type="text"
               id="email"
               class="form-input"
               [formControl]="personalInfoForm.email"
               placeholder="Enter your email"
               required autofocus="autofocus" />
        <div *ngIf="checkFormControl(personalInfoForm.email)"
             class="alert-danger-parent">
          <div class="alert-danger" *ngIf="checkFormControl(personalInfoForm.email)">
            Enter your email
          </div>
        </div>
      </div>
      <div class="form-panel-dark-on-white">
        <label class="mt-3" for="phone"> Phone number </label>
        <input type="text"
               id="phone"
               class="form-input"
               [formControl]="personalInfoForm.phone"
               placeholder="Enter your name"
               required autofocus="autofocus" />
        <div *ngIf="checkFormControl(personalInfoForm.phone)"
             class="alert-danger-parent">
          <div class="alert-danger" *ngIf="checkFormControl(personalInfoForm.phone)">
            Enter your phone number
          </div>
        </div>
      </div>
    </form>
    <div class="mt-3">
      <button class="p-btn-white-on-white" matStepperPrevious>Back</button>
      <button class="p-btn-dark-on-white"  matStepperNext>Next</button>
    </div>
  </mat-step>

  <mat-step [stepControl]="addressInfo" label="Fill out your address">
    <form [formGroup]="addressInfo" class="col-md-6">
      <div class="form-panel-dark-on-white">
      <label class="mt-3" for="country"> Country </label>
      <input type="text"
             id="country"
             class="form-input"
             [formControl]="addressInfoForm.country"
             placeholder="Enter email"
             required autofocus="autofocus" />
      <div *ngIf="checkFormControl(addressInfoForm.country)"
           class="alert-danger-parent">
        <div class="alert-danger" *ngIf="checkFormControl(addressInfoForm.country)">
          Enter country
        </div>
      </div>
    </div>
    <div class="grid-container">
      <div>
        <div class="form-panel-dark-on-white">
          <label class="mt-3" for="country"> City </label>
          <input type="text"
                 id="city"
                 class="form-input"
                 [formControl]="addressInfoForm.city"
                 placeholder="Enter city"
                 required autofocus="autofocus" />
          <div *ngIf="checkFormControl(addressInfoForm.city)"
               class="alert-danger-parent">
            <div class="alert-danger" *ngIf="checkFormControl(addressInfoForm.city)">
              Enter country
            </div>
          </div>
        </div>
      </div>
      <div>
        <div class="form-panel-dark-on-white">
          <label class="mt-3" for="country"> Postal code </label>
          <input type="text"
                 id="postalCode"
                 class="form-input"
                 [formControl]="addressInfoForm.postalCode"
                 placeholder="Enter postal code"
                 required autofocus="autofocus" />
          <div *ngIf="checkFormControl(addressInfoForm.postalCode)"
               class="alert-danger-parent">
            <div class="alert-danger" *ngIf="checkFormControl(addressInfoForm.postalCode)">
              Enter postal code
            </div>
          </div>
        </div>
      </div>

    </div>

    <!-- Full address -->
    <div class="form-panel-dark-on-white">
          <label class="mt-3" for="country"> Address </label>
          <textarea type="text"
                 id="fullAddress"
                 class="form-input" rows="2"
                 [formControl]="addressInfoForm.fullAddress"
                 placeholder="Enter full address (city district, street, house)"
                 required autofocus="autofocus"></textarea>
          <div *ngIf="checkFormControl(addressInfoForm.fullAddress)"
               class="alert-danger-parent">
            <div class="alert-danger" *ngIf="checkFormControl(addressInfoForm.fullAddress)">
              Enter full address
            </div>
          </div>
        </div>
    </form>
    <div class="mt-3">
      <button class="p-btn-white-on-white" matStepperPrevious>Back</button>
      <button class="p-btn-dark-on-white"  matStepperNext>Next</button>
    </div>
  </mat-step>

  <mat-step [stepControl]="cardInfo" label="Fill out your card">
    <form [formGroup]="cardInfo" class="col-md-5">
      <div class="form-panel-dark-on-white">
      <label class="mt-3" for="country"> Card number </label>
      <input type="text"
             id="cardNumber"
             class="form-input"
             [formControl]="cardInfoForm.cardNumber"
             placeholder="Enter card number"
             required autofocus="autofocus" />
      <div *ngIf="checkFormControl(cardInfoForm.cardNumber)"
           class="alert-danger-parent">
        <div class="alert-danger" *ngIf="checkFormControl(cardInfoForm.cardNumber)">
              Enter valid cvv
        </div>

      </div>
    </div>

<!--Card date and cvv      -->
    <div class="grid-container-cvv">
      <div>
        <div class="form-panel-dark-on-white">
          <label class="mt-3" for="country"> Expiration date </label>
          <input type="month"
                 id="date"
                 [min]="minDate"
                 [max]="maxDate"
                 class="form-input"
                 [formControl]="cardInfoForm.cardDate"
                 placeholder="Enter city"
                 required autofocus="autofocus" />
          <div *ngIf="checkFormControl(cardInfoForm.cardDate)"
               class="alert-danger-parent">
            <div class="alert-danger" *ngIf="checkFormControl(cardInfoForm.cardDate)">
              Enter valid date
            </div>

          </div>
        </div>
      </div>
      <div>
        <div class="form-panel-dark-on-white">
          <label class="mt-3" for="country"> Cvv </label>
          <input type="text"
                 id="cardCvv"
                 class="form-input"
                 [formControl]="cardInfoForm.cardCvv"
                 placeholder="Enter postal code"
                 required autofocus="autofocus" />
          <div *ngIf="checkFormControl(cardInfoForm.cardCvv)"
               class="alert-danger-parent">
            <div class="alert-danger" *ngIf="checkFormControl(cardInfoForm.cardCvv)">
              Enter valid cvv
            </div>

          </div>
        </div>
      </div>
    </div>
      <div class="form-panel-dark-on-white">
        <label class="mt-3" for="postalCode"> Cardholder name </label>
        <input type="text"
               id="holderName"
               class="form-input"
               [formControl]="cardInfoForm.cardholderName"
               placeholder="Enter your name"
               required autofocus="autofocus" />
        <div *ngIf="checkFormControl(cardInfoForm.cardholderName)"
             class="alert-danger-parent">
          <div class="alert-danger" *ngIf="checkFormControl(cardInfoForm.cardholderName)">
            Enter your cardholder name
          </div>
        </div>
      </div>
    </form>
    <div class="mt-3">
      <button class="p-btn-white-on-white" matStepperPrevious>Back</button>
      <button class="p-btn-dark-on-white"  matStepperNext>Next</button>
    </div>
  </mat-step>

  <mat-step>
    <ng-template matStepLabel>Done</ng-template>
    <p>By clicking 'Order', new order will be placed after validations and checks</p>
    <div class="mt-3">
      <button class="p-btn-dark-on-white" matStepperPrevious (click)="order()">Order</button>
    </div>
  </mat-step>
</mat-stepper>
